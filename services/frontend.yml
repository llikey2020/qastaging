variables:
  FRONTEND_SERVICE_NAME: frontend

Frontend helm prepare:
  extends:
    - .helm-prepare
  rules:
    - if: '($DEPLOY_PROJECT == "frontend" || $DEPLOY_PROJECT == "all") && $ONLY_CLEANUP == "false"'
  variables:
    SERVICE_NAME: ${FRONTEND_SERVICE_NAME}
    PACKAGE_NAME: sdp-frontend-helm-chart
    FILE_NAME: sdp-frontend-0.0.2.tgz
    PACKAGE_VERSION: "0.0.2"
    ID: 46
    IMAGE_TAG: ${FRONTEND_IMAGE_TAG}
  script:
    - !reference [".helm-prepare", "script"]
    - |
      cat << EOF > ${OVERRIDES_FILE}
      backendServices:
        - name: METASTORE
          value: ${SCHEMA_SERVICE_NAME}
        - name: METASTORE_NAMESPACE
          value: ${SERVICE_NAMESPACE}
        - name: SPARK_HISTORY_SERVER
          value: ${HISTORY_SERVICE_NAME}
        - name: SPARK_HISTORY_SERVER_NAMESPACE
          value: ${SERVICE_NAMESPACE}
        - name: ZEPPELIN
          value: zeppelin-server #${ZEPPELIN_SERVICE_NAME}
        - name: ZEPPELIN_NAMESPACE
          value: ${SERVICE_NAMESPACE}
      image:
        registry: ${REGISTRY}
        dockerTag: ${IMAGE_TAG}
        imagePullPolicy: Always
      imagePullSecrets:
        - name: ${PULL_SECRET}
      fullnameOverride: ${FRONTEND_SERVICE_NAME}
      EOF
